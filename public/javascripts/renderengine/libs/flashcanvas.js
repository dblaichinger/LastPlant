/*
 * FlashCanvas Pro
 *
 * Copyright (c) 2009      Tim Cameron Ryan
 * Copyright (c) 2009-2010 Shinya Muramatsu
 */
window.ActiveXObject&&!window.CanvasRenderingContext2D&&function(){function z(a){var b=a.h;arguments.callee[b]||(arguments.callee[b]=0);return arguments.callee[b]++}function A(){if(document.readyState==="complete"){document.detachEvent(B,A);for(var a=document.getElementsByTagName("canvas"),b=0,c=a.length;b<c;++b){var d=a[b];d.getContext||x.initElement(d)}}}function C(){var a=event.propertyName;if(a==="width"||a==="height"){var b=event.srcElement,c=b.getContext("2d"),d=parseInt(b[a]);if(isNaN(d)||
d<0)d=a==="width"?300:150;else if(d===0)d=1;b.style[a]=d+"px";c.M(b.clientWidth,b.clientHeight)}}function D(){var a=event.srcElement,b=a.parentNode;a.blur();b.focus()}function q(){event.button&2&&event.srcElement.parentNode.setCapture()}function r(){event.button&2&&event.srcElement.parentNode.releaseCapture()}function E(){window.detachEvent(F,E);for(var a=document.getElementsByTagName("canvas"),b=0,c=a.length;b<c;++b){var d=a[b],f=d.firstChild,g;for(g in f)if(typeof f[g]==="function")f[g]=null;for(g in d)if(typeof d[g]===
"function")d[g]=null;d.detachEvent(G,C);f.detachEvent(H,D);f.detachEvent(s,q);d.detachEvent(t,r)}window[I]=null;window[J]=null;window[K]=null;window[L]=null;window[M]=null}function m(a,b){return b||!h.i?(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;"):encodeURIComponent(a)}var I="CanvasRenderingContext2D",J="CanvasGradient",K="CanvasPattern",L="FlashCanvas",M="G_vmlCanvasManager",H="onfocus",s="onmousedown",t="onmouseup",G="onpropertychange",B="onreadystatechange",F="onunload",k;try{k=(new ActiveXObject("ShockwaveFlash.ShockwaveFlash")).GetVariable("$version").match(/[\d,]+/)[0].replace(/,/g,
".")}catch(R){k=false}var N=function(){return "/libs/";}().replace(/[^\/]+$/,""),n;n=parseInt(k)>9?N+"flash10canvas.swf":N+"flash9canvas.swf";var e=new function(a){for(var b=0,c=a.length;b<c;b++)this[a[b]]=b}(["toDataURL","save","restore","scale","rotate","translate","transform","setTransform","globalAlpha","globalCompositeOperation","strokeStyle","fillStyle","createLinearGradient","createRadialGradient",
"createPattern","lineWidth","lineCap","lineJoin","miterLimit","shadowOffsetX","shadowOffsetY","shadowBlur","shadowColor","clearRect","fillRect","strokeRect","beginPath","closePath","moveTo","lineTo","quadraticCurveTo","bezierCurveTo","arcTo","rect","arc","fill","stroke","clip","isPointInPath","font","textAlign","textBaseline","fillText","strokeText","measureText","drawImage","createImageData","getImageData","putImageData","addColorStop"]),u={},o={},l={},v={},h={i:true,F:0,L:false};if(k==="10.1.53.64"){h.i=
false;h.F=30}function p(a,b){this.canvas=a;this.B=b;this.h=a.uniqueID;this.I();this.j=""}p.prototype={save:function(){this.A.push({globalAlpha:this.globalAlpha,globalCompositeOperation:this.globalCompositeOperation,strokeStyle:this.strokeStyle,fillStyle:this.fillStyle,lineWidth:this.lineWidth,lineCap:this.lineCap,lineJoin:this.lineJoin,miterLimit:this.miterLimit,shadowOffsetX:this.shadowOffsetX,shadowOffsetY:this.shadowOffsetY,shadowBlur:this.shadowBlur,shadowColor:this.shadowColor,font:this.font,
textAlign:this.textAlign,textBaseline:this.textBaseline});this.d();this.e();this.l();this.k();this.t();this.s();this.a.push(e.save)},restore:function(){if(this.A.length>0){var a=this.A.pop();this.globalAlpha=a.globalAlpha;this.globalCompositeOperation=a.globalCompositeOperation;this.strokeStyle=a.strokeStyle;this.fillStyle=a.fillStyle;this.lineWidth=a.lineWidth;this.lineCap=a.lineCap;this.lineJoin=a.lineJoin;this.miterLimit=a.miterLimit;this.shadowOffsetX=a.shadowOffsetX;this.shadowOffsetY=a.shadowOffsetY;
this.shadowBlur=a.shadowBlur;this.shadowColor=a.shadowColor;this.font=a.font;this.textAlign=a.textAlign;this.textBaseline=a.textBaseline}this.a.push(e.restore)},scale:function(a,b){this.a.push(e.scale,a,b)},rotate:function(a){this.a.push(e.rotate,a)},translate:function(a,b){this.a.push(e.translate,a,b)},transform:function(a,b,c,d,f,g){this.a.push(e.transform,a,b,c,d,f,g)},setTransform:function(a,b,c,d,f,g){this.a.push(e.setTransform,a,b,c,d,f,g)},d:function(){var a=this.a;if(this.m!==this.globalAlpha){this.m=
this.globalAlpha;a.push(e.globalAlpha,this.m)}if(this.n!==this.globalCompositeOperation){this.n=this.globalCompositeOperation;a.push(e.globalCompositeOperation,this.n)}},l:function(){if(this.K!==this.strokeStyle){var a=this.K=this.strokeStyle;this.a.push(e.strokeStyle,typeof a==="object"?a.id:m(a))}},k:function(){if(this.H!==this.fillStyle){var a=this.H=this.fillStyle;this.a.push(e.fillStyle,typeof a==="object"?a.id:m(a))}},createLinearGradient:function(a,b,c,d){this.a.push(e.createLinearGradient,
a,b,c,d);this.g.push(e.createLinearGradient,a,b,c,d);return new w(this)},createRadialGradient:function(a,b,c,d,f,g){this.a.push(e.createRadialGradient,a,b,c,d,f,g);this.g.push(e.createRadialGradient,a,b,c,d,f,g);return new w(this)},createPattern:function(a,b){if(a.tagName.toUpperCase()==="IMG"){var c=a.getAttribute("src",2),d=this.h;this.a.push(e.createPattern,c,b);this.g.push(e.createPattern,c,b);if(!o[d][c]&&u[d]){this.f();++l[d];o[d][c]=true}return new O(this)}},t:function(){var a=this.a;if(this.q!==
this.lineWidth){this.q=this.lineWidth;a.push(e.lineWidth,this.q)}if(this.o!==this.lineCap){this.o=this.lineCap;a.push(e.lineCap,this.o)}if(this.p!==this.lineJoin){this.p=this.lineJoin;a.push(e.lineJoin,this.p)}if(this.r!==this.miterLimit){this.r=this.miterLimit;a.push(e.miterLimit,this.r)}},e:function(){var a=this.a;if(this.w!==this.shadowOffsetX){this.w=this.shadowOffsetX;a.push(e.shadowOffsetX,this.w)}if(this.z!==this.shadowOffsetY){this.z=this.shadowOffsetY;a.push(e.shadowOffsetY,this.z)}if(this.u!==
this.shadowBlur){this.u=this.shadowBlur;a.push(e.shadowBlur,this.u)}if(this.v!==this.shadowColor){this.v=this.shadowColor;a.push(e.shadowColor,this.v)}},clearRect:function(a,b,c,d){this.a.push(e.clearRect,a,b,c,d);this.b||this.c()},fillRect:function(a,b,c,d){this.d();this.e();this.k();this.a.push(e.fillRect,a,b,c,d);this.b||this.c()},strokeRect:function(a,b,c,d){this.d();this.e();this.l();this.t();this.a.push(e.strokeRect,a,b,c,d);this.b||this.c()},beginPath:function(){this.a.push(e.beginPath)},closePath:function(){this.a.push(e.closePath)},
moveTo:function(a,b){this.a.push(e.moveTo,a,b)},lineTo:function(a,b){this.a.push(e.lineTo,a,b)},quadraticCurveTo:function(a,b,c,d){this.a.push(e.quadraticCurveTo,a,b,c,d)},bezierCurveTo:function(a,b,c,d,f,g){this.a.push(e.bezierCurveTo,a,b,c,d,f,g)},arcTo:function(a,b,c,d,f){this.a.push(e.arcTo,a,b,c,d,f)},rect:function(a,b,c,d){this.a.push(e.rect,a,b,c,d)},arc:function(a,b,c,d,f,g){this.a.push(e.arc,a,b,c,d,f,g?1:0)},fill:function(){this.d();this.e();this.k();this.a.push(e.fill);this.b||this.c()},
stroke:function(){this.d();this.e();this.l();this.t();this.a.push(e.stroke);this.b||this.c()},clip:function(){this.a.push(e.clip)},isPointInPath:function(a,b){this.a.push(e.isPointInPath,a,b);return this.f()==="true"},s:function(){var a=this.a;if(this.j!==this.font){this.j=this.font;a.push(e.font,v[this.h].offsetHeight,this.j)}if(this.C!==this.textAlign){this.C=this.textAlign;a.push(e.textAlign,this.C)}if(this.D!==this.textBaseline){this.D=this.textBaseline;a.push(e.textBaseline,this.D)}},fillText:function(a,
b,c,d){this.d();this.k();this.e();this.s();this.a.push(e.fillText,m(a),b,c,d||0);this.b||this.c()},strokeText:function(a,b,c,d){this.d();this.l();this.e();this.s();this.a.push(e.strokeText,m(a),b,c,d||0);this.b||this.c()},measureText:function(a){var b=v[this.h];try{b.style.font=this.font}catch(c){}b.innerText=a.replace(/[ \n\f\r]/g,"\t");return new Q(b.offsetWidth)},drawImage:function(){var a=arguments,b=a.length;if(a[0].tagName.toUpperCase()==="IMG"){var c=a[0].getAttribute("src",2),d=this.h;this.d();
this.e();if(b===3)this.a.push(e.drawImage,b,c,a[1],a[2]);else if(b===5)this.a.push(e.drawImage,b,c,a[1],a[2],a[3],a[4]);else if(b===9)this.a.push(e.drawImage,b,c,a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8]);else return;if(!o[d][c]&&u[d]){this.f();++l[d];o[d][c]=true}else this.b||this.c()}},createImageData:function(){var a=arguments,b;if(a.length===2){b=a[0];a=a[1]}else{b=a[0].width;a=a[0].height}return new P(b,a)},getImageData:function(a,b,c,d){this.a.push(e.getImageData,a,b,c,d);a=this.f();c=typeof JSON===
"object"?JSON.parse(a):document.documentMode?eval(a):a.slice(1,-1).split(",");a=c.shift();b=c.shift();return new P(a,b,c)},putImageData:function(){var a=arguments,b=a.length,c=a[0];if(c){var d=c.width,f=c.height;c=c.data;if(!(!d||!f||!c)){if(b===3)this.a.push(e.putImageData,b,d,f,c.toString(),a[1],a[2]);else b===7&&this.a.push(e.putImageData,b,d,f,c.toString(),a[1],a[2],a[3],a[4],a[5],a[6]);this.b||this.c()}}},I:function(){this.globalAlpha=this.m=1;this.globalCompositeOperation=this.n="source-over";
this.fillStyle=this.H=this.strokeStyle=this.K="#000000";this.lineWidth=this.q=1;this.lineCap=this.o="butt";this.lineJoin=this.p="miter";this.miterLimit=this.r=10;this.shadowBlur=this.u=this.shadowOffsetY=this.z=this.shadowOffsetX=this.w=0;this.shadowColor=this.v="rgba(0,0,0,0)";this.font=this.j="10px sans-serif";this.textAlign=this.C="start";this.textBaseline=this.D="alphabetic";this.a=[];this.g=[];this.A=[];this.b=null;this.J=1},c:function(){var a=this;a.b=setTimeout(function(){if(l[a.h])a.c();else{a.b=
null;a.f(h.i,true)}},h.F)},N:function(){clearTimeout(this.b);this.b=null},f:function(a,b){if(this.a.length){this.b&&this.N();var c=this.B,d=this.a.join("\u0001");this.a=[];this.g=[];if(a){c.flashvars="c="+d;c.width=c.clientWidth+this.J;this.J^=-2}else{if(h.i&&!b)d=m(decodeURIComponent(d),true);return c.CallFunction('<invoke name="postCommands" returntype="javascript"><arguments><string>'+d+"</string></arguments></invoke>")}}},M:function(a,b){this.B.resize(a,b);this.B.width=a;if(this.g.length){this.a=
this.g;this.f()}this.I()}};function w(a){this.G=a;this.id=z(a)}w.prototype={addColorStop:function(a,b){this.G.a.push(e.addColorStop,this.id,a,b);this.G.g.push(e.addColorStop,this.id,a,b)}};function O(a){this.id=z(a)}function Q(a){this.width=a}function P(a,b,c){if(!c){c=[];for(var d=0,f=a*b*4;d<f;++d)c[d]=0}this.width=a;this.height=b;this.data=c}var x={initElement:function(a){var b=parseInt(a.getAttribute("width")),c=parseInt(a.getAttribute("height"));if(isNaN(b)||b<0)b=300;if(isNaN(c)||c<0)c=150;
a.style.width=b+"px";a.style.height=c+"px";b=a.uniqueID;c="external"+b;u[b]=false;o[b]={};l[b]=1;a.innerHTML='<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="'+location.protocol+'//fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,0,0" width="100%" height="100%" id="'+c+'"><param name="allowScriptAccess" value="always"><param name="flashvars" value="id='+c+'"><param name="wmode" value="transparent"></object><span style="margin:0;padding:0;border:0;display:inline-block;position:static;height:1em;overflow:visible;white-space:nowrap"></span>';
var d=a.firstChild;v[b]=a.lastChild;var f=document.body.contains;if(f(a))d.movie=n;else var g=setInterval(function(){if(f(a)){clearInterval(g);d.movie=n}},0);if(document.compatMode==="BackCompat"||!window.XMLHttpRequest)v[b].style.overflow="hidden";var i=new p(a,d);a.getContext=function(j){return j==="2d"?i:null};a.toDataURL=function(){var j=arguments,y=j[0]?j[0].toLowerCase():"image/png";y==="image/jpeg"?i.a.push(e.toDataURL,y,j[1]||0.5):i.a.push(e.toDataURL,y);return i.f().slice(1,-1)};d.attachEvent(H,
D);if(h.L){d.attachEvent(s,q);a.attachEvent(t,r)}return a},setOptions:function(a){for(var b in a){var c=a[b];switch(b){case "turbo":h.i=c;break;case "delay":h.F=c;break;case "disableContextMenu":c=c;for(var d=document.getElementsByTagName("canvas"),f=0,g=d.length;f<g;++f){var i=d[f];if(i.getContext){var j=i.firstChild;if(c){j.attachEvent(s,q);i.attachEvent(t,r)}else{j.detachEvent(s,q);i.detachEvent(t,r)}}}h.L=c;break}}},trigger:function(a,b){document.getElementById("external"+a).parentNode.fireEvent("on"+
b)},unlock:function(a,b){l[a]&&--l[a];if(b){var c=document.getElementById("external"+a);c.parentNode.attachEvent(G,C);c.resize(c.clientWidth,c.clientHeight);u[a]=true}}};document.createElement("canvas");document.createStyleSheet().cssText="canvas{display:inline-block;overflow:hidden;width:300px;height:150px}";document.attachEvent(B,A);window.attachEvent(F,E);if(n.indexOf(location.protocol+"//"+location.host+"/")===0){k=new ActiveXObject("Microsoft.XMLHTTP");k.open("GET",n,false);k.send(null)}window[I]=
p;window[J]=w;window[K]=O;window[L]=x;window[M]={init:function(){},init_:function(){},initElement:x.initElement};keep=[p.measureText,p.createImageData]}();
